# Personalized Yelp Recommender System

A bias-aware restaurant recommendation system that personalizes discovery by modeling  
**user–item compatibility** rather than relying on global average ratings.

This project demonstrates an end-to-end recommender pipeline: from large-scale data ingestion
and aggregation to GPU-accelerated contrastive learning and personalized inference.

---

## Motivation

Most review platforms (e.g. Yelp) rank businesses using **average star ratings**, implicitly
treating reviews as reflections of objective quality.

In reality, ratings are **taste-dependent**.  
For example, a user unfamiliar with European cuisine may rate a European restaurant poorly,
even if the restaurant is high-quality for the right audience. Such reviews introduce
**taste-mismatch bias**, burying niche but high-quality businesses.

This project addresses that bias by learning **personalized user–restaurant compatibility**
instead of global quality scores.

---

## Core Idea

- Ratings are treated as **signals of compatibility**, not objective truth
- A negative review only pushes *that user* away from the restaurant
- Restaurants are still discoverable by users whose preferences align

This prevents majority tastes from dominating rankings and improves niche discovery.

---

## Approach

- Built a **two-tower neural recommender system**
  - User tower learns taste embeddings
  - Business tower learns restaurant embeddings
- Trained embeddings using **contrastive learning with negative sampling**
- Modeled recommendations as a **ranking problem**, not regression on stars
- Used GPU acceleration for scalable training

---

## System Architecture
# Personalized Yelp Recommender System

A bias-aware restaurant recommendation system that personalizes discovery by modeling  
**user–item compatibility** rather than relying on global average ratings.

This project demonstrates an end-to-end recommender pipeline: from large-scale data ingestion
and aggregation to GPU-accelerated contrastive learning and personalized inference.

---

## Motivation

Most review platforms (e.g. Yelp) rank businesses using **average star ratings**, implicitly
treating reviews as reflections of objective quality.

In reality, ratings are **taste-dependent**.  
For example, a user unfamiliar with European cuisine may rate a European restaurant poorly,
even if the restaurant is high-quality for the right audience. Such reviews introduce
**taste-mismatch bias**, burying niche but high-quality businesses.

This project addresses that bias by learning **personalized user–restaurant compatibility**
instead of global quality scores.

---

## Core Idea

- Ratings are treated as **signals of compatibility**, not objective truth
- A negative review only pushes *that user* away from the restaurant
- Restaurants are still discoverable by users whose preferences align

This prevents majority tastes from dominating rankings and improves niche discovery.

---

## Approach

- Built a **two-tower neural recommender system**
  - User tower learns taste embeddings
  - Business tower learns restaurant embeddings
- Trained embeddings using **contrastive learning with negative sampling**
- Modeled recommendations as a **ranking problem**, not regression on stars
- Used GPU acceleration for scalable training

---

## System Architecture
- Yelp Open Dataset (JSON)
- PostgreSQL Ingestion
- User–Item Interaction Matrix 
- Two-Tower Contrastive Training (GPU)
- Personalized Top-K Recommendations
---

## Data

- **Source:** Yelp Open Dataset (~6M reviews)
- Explicit feedback: star ratings
- Implicit feedback: user interactions
- Aggregated into a signed user–item interaction matrix

Due to GitHub file size limits, raw Yelp data is **not included** in this repository.

---

## Interaction Modeling

Each (user, business) pair is represented by a **signed interaction weight**:

- Positive values → preference alignment
- Negative values → preference mismatch
- Magnitude reflects strength of signal

This matrix forms the training data for the recommender.

---

## Model

- **Architecture:** Two-tower embedding model
- **Scoring function:** Dot product between user and business embeddings
- **Loss:** InfoNCE-style contrastive loss with negative sampling
- **Training:** GPU-accelerated PyTorch

The contrastive objective pulls users closer to preferred restaurants while pushing them away
from sampled negatives, enabling efficient large-scale learning.

---

## Inference

Personalized recommendations are generated by:

1. Selecting a user embedding
2. Computing dot-product similarity with all business embeddings
3. Ranking businesses by score
4. Returning top-K results

---

## Demo

Generate personalized restaurant recommendations:

```bash
python inference/recommend.py
